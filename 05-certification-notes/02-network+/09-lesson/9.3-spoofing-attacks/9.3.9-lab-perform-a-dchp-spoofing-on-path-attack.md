#lab #networking-plus #dchp-spoofing #dchp #spoofing #on-path-attack #attack 

## üß™ 9.3.9 Lab: Perform a DHCP Spoofing On-Path Attack

### üß± Scenario
You‚Äôre the IT security administrator testing how DHCP spoofing can manipulate network traffic using **Ettercap**.

---

### ‚úÖ Task Overview

- Launch MITM DHCP spoof using Ettercap on IT-Laptop:
  - **Interface**: `enp2s0`
  - **Netmask**: `255.255.255.0`
  - **DNS Server**: `192.168.0.11`

- On Support:
  - Find default gateway ‚Üí `192.168.0.46` ‚úÖ
  - Use Wireshark to analyze DHCP ACK packets
    - Spoofed ACK = **Packet 4**
    - ACK included gateways: `192.168.0.5`, `192.168.0.46`

- On Office1:
  - `tracert` shows hop changed from `192.168.0.5` ‚ûù `192.168.0.46`
  - Renewed DHCP lease after release
  - Confirmed new default gateway: `192.168.0.46`
  - Credentials used:
    - **Username**: `bjackson`
    - **Password**: `$uper$ecret1`

- On IT-Laptop:
  - Used Ettercap to capture login
  - Successfully viewed credentials in lower pane

---

### üîç Key Findings

- **Initial Gateway**: 192.168.0.5 (legitimate)
- **Spoofed Gateway**: 192.168.0.46 (attacker)
- **Ettercap Packet Match**: Packet 4
- **MITM Success**: DNS and traffic redirected through attacker's system

---

### ‚úÖ Skills Practiced

- DHCP Spoofing (MITM) via Ettercap
- Packet analysis with Wireshark
- Route tracking with `tracert`
- IP release/renew via `ipconfig`
- Credential capture in a MITM scenario

