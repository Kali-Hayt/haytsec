## 4.1.3 â€“ Address Resolution Protocol (ARP)

### ðŸ§± What Is ARP?

**ARP (Address Resolution Protocol)** is used to **map an IPv4 address to a MAC address** on a local Ethernet network.

- IP identifies the destination **logically** (Layer 3)
- But to transmit data on the network, the system needs the **physical address** â€” the **MAC** (Layer 2)
- ARP performs this **translation** between IP and MAC addresses

---

### ðŸ”„ How ARP Works

When two devices are in the **same subnet (broadcast domain)**:

1. Sender doesnâ€™t know the MAC of the destination IP
2. It sends a **broadcast ARP request**:
   > â€œWho has IP 192.168.1.5? Tell 192.168.1.10â€
3. The device with that IP sends back a **unicast ARP reply** with its MAC
4. Sender uses that MAC to build the **Ethernet frame** and send the actual data

âœ… This is local resolution â€” done without a router, inside the subnet.

---

### ðŸŒ ARP and Remote Destinations

If the destination IP is **outside the subnet**:

- The host sends the packet to its **default gateway** (usually a router)
- But first, it must use ARP to **discover the MAC address of the gateway**
- The host builds a frame addressed to the **routerâ€™s MAC**, not the final IP destination

> ðŸ§± **Local MAC lookup always happens â€” even for traffic headed to the internet**

---

### ðŸ“¡ ARP on Routers

Routers also use ARP for their own **Ethernet interfaces**, to communicate on local networks.

- The router needs to know the MAC addresses of hosts itâ€™s forwarding packets to
- On the **public side**, the router may use a **different framing/addressing system** (e.g., DSL, fiber, or cable protocols)

---

### ðŸ” Summary: When ARP Happens

| Scenario                             | Does ARP Happen? | Who's MAC Is Looked Up?       |
|--------------------------------------|------------------|-------------------------------|
| Same subnet communication            | âœ… Yes           | Destination deviceâ€™s MAC      |
| Cross-subnet communication           | âœ… Yes           | Routerâ€™s MAC (default gateway)|
| Public internet                      | âœ… Yes (initially)| ISP gatewayâ€™s MAC             |

> ARP = the bridge between Layer 3 (IP) and Layer 2 (MAC)

