## 6.5.10 DNS Security

DNS is a critical service that should be configured to resist spoofing and poisoning attacks. These attacks mean that a threat actor changes the record returned by a DNS query to point to a different IP address, potentially redirecting the victim machine to connect to a malicious host.

---

### 🛡️ DNS Security Extensions (DNSSEC)

[DNS Security Extensions (DNSSEC)](https://en.wikipedia.org/wiki/Domain_Name_System_Security_Extensions) help mitigate spoofing and poisoning attacks on DNS servers by validating DNS responses.

- When **DNSSEC is enabled**, the **authoritative server** for the zone signs a “package” of resource records (RRset) with a **Zone Signing Key (ZSK)**.
- The server then returns:
  - The **RRset**
  - Its **digital signature**
  - The **public key** (used by resolvers to verify the signature)

➡️ This process ensures the DNS data hasn’t been tampered with in transit.

---

### 🔐 Key Signing Structure

- The **Zone Signing Key (ZSK)** is signed by a **Key Signing Key (KSK)**.
- KSKs are validated by:
  - The parent domain or host ISP
  - Top-level domains (via Regional Internet Registries)
  - DNS root servers, which are **self-validated** using M-of-N trust models

This establishes a **chain of trust** from the root zone down to each subdomain.

---

### 👨‍💻 DNS Client Security

Even if the DNS record is valid (DNSSEC), the **path** between the client and resolver can still be snooped.

There are two main protocols to protect DNS client queries:

- **DoT (DNS over Transport Layer Security)**  
  - Uses **TLS** to encrypt DNS queries.
  - Validates the **resolver’s digital certificate**
  - Prevents MITM spoofing of the resolver.
  - Uses **TCP port 853**

- **DoH (DNS over HTTPS)**  
  - Encapsulates DNS traffic inside **HTTPS**
  - Uses **TCP port 443**
  - Obfuscates DNS queries as normal web traffic
  - Adds overhead (extra HTTP headers), but increases privacy

---

### 📦 Privacy Benefits

Plain-text DNS queries are visible to any device in the path between client and resolver.  

**DoT and DoH** prevent this by encrypting the traffic:

- ✅ Stops attackers from **snooping or tampering**
- ✅ Preferred by privacy advocates and some enterprises

🔍 However, **corporate networks** may still:
- Use internal resolvers (not public DoT/DoH)
- Monitor DNS traffic for visibility and threat detection

---

