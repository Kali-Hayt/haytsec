## 7.1.2 Network Time Protocol (NTP)

- NTP syncs clocks across systems so they operate on the same time.
- Critical for:
  - ✅ Authentication
  - ✅ Logging & auditing
  - ✅ Scheduling and backups

- 🧱 Protocol: UDP port **123**

---

## 🧱 Stratum Levels

- **Stratum 1**: Directly linked to accurate time source (e.g., atomic clock or GPS).
- **Stratum 2**: Syncs with a stratum 1 server.
- Each higher stratum = one hop further from original source.

- ⬇️ Lower stratum = more accurate  
- 🔁 Devices can act as both NTP clients and servers.

---

## ✅ Best Practices

- Configure **at least 3 time sources** for reliability.
- Set them up as peers to detect bad sources and maintain accuracy.
- Commonly handled by network directory servers (like Active Directory).

---

## 🧰 Configuration Tools

- **Linux**: `/etc/ntp.conf`
- **Windows**: `w32tm` command
- 🧱 **SNTP** (Simple NTP):
  - Lightweight version of NTP
  - Cannot serve time to others
  - Same port: UDP 123

---

## 🕓 Time Drift Handling

- **Slew method**:
  - Gradual time correction (few milliseconds at a time)
  - ✅ Safer, avoids system disruptions

- **Slam method**:
  - Immediate time reset
  - ❌ Risky: can break apps or cause data corruption

---

## ❌ If Time is Off...

- Systems may fail authentication.
- Logs might be inaccurate.
- Expect vague or invalid token errors.
- Always **check time sync first** when troubleshooting.

---

## 🔐 Secure Time Sync with NTS

- **NTS (Network Time Security)** = NTP secured with **TLS**
- Protects against:
  - Spoofed time sources
  - Tampered synchronization packets

- ✅ NTS uses:
  - TCP port **4460**
  - May also support **3443** and **4443** (legacy draft ports)

