#networking-plus #IDS #IPS #implement-intrusion-prevention #security #lab 

## 🧪 Lab 11.1.9 – Implement Intrusion Prevention with Snort (pfSense)

### 🎯 Objective

Deploy and configure **Snort** as an **Intrusion Prevention System (IPS)** on the **WAN interface** of a pfSense firewall.

Snort will:
- Inspect incoming traffic
- Use threat intelligence rules
- Block offending IPs
- Log alerts to system logs

---

### ✅ Lab Tasks Completed

#### 1. Sign into pfSense
- **Username:** `admin`
- **Password:** `P@ssw0rd` (with zero)

#### 2. Access Snort Global Settings
- Menu: `Services > Snort > Global Settings`

#### 3. Enable Rule Sources
- ✅ Enable **Snort VRT rules** (Oinkmaster code: `992acca37a4dbd7`)
- ✅ Enable **Snort GPLv2 Community rules**
- ✅ Enable **Emerging Threats (ET) Open rules**

#### 4. Enable Sourcefire OpenAppID
- ✅ `Enable OpenAppID`
- ✅ `Enable RULES OpenAppID`

#### 5. Configure Rule Update Schedule
- Update every **4 days**
- Start time: **00:10 a.m.**
- Hide deprecated categories

#### 6. General Snort Settings
- Blocked hosts removed after: **1 Day**
- Enable **Startup/Shutdown Logging**

#### 7. Snort Interface Settings (WAN)
- Add Snort to **WAN interface**
- Description: `Snort-WAN`
- Enable:
  - `Send Alerts to System Log`
  - `Block Offenders`
- Save

#### 8. Start Snort
- Go to `Snort Interfaces > Status`
- ✅ Start Snort on WAN (checkmark confirms success)

---

### 🧠 What This Means

- Snort is now **actively inspecting live WAN traffic**
- It can detect + block attackers **in real time**
- It's updated with **community and threat intel rules**
- Your pfSense box now has **real inline IPS capabilities**

> 🧱 This is **defense-in-depth**: firewall + IPS + logging + auto-blocking

---

### 🏆 Lab Result

**Score:** 100%  
**Time Spent:** 4 minutes 2 seconds  
**Candidate:** John Hayt

