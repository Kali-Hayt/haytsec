#networking-plus #port-guard #port #DAI #dynamic-ARP #DCHP #snooping 

## 10.4.6 – Port Guards

### 🛡️ Overview

Port guard features are switch-level protections used to **detect and block malicious traffic**, enforce access control, and maintain network integrity.

---

### 🔐 Key Port Security Features

#### ✅ Dynamic ARP Inspection (DAI)
- Prevents **ARP spoofing** and **gratuitous ARP attacks**
- Validates ARP packets against a trusted **IP:MAC** database
- Ensures packets are **properly formed** and **not spoofed**

#### ✅ DHCP Snooping
- Inspects **DHCP traffic** on access ports
- Blocks rogue DHCP servers
- Allows DHCP offers **only from trusted ports**

#### ✅ IPv6 Protections
- **ND Inspection** and **RA Guard** protect IPv6 networks
  - Detect spoofed **Neighbor Discovery** messages
  - Block malicious **Router Advertisements**
- Many systems have IPv6 enabled by default — disabling it may break things  
  → Enable these protections **instead**

---

### 🧱 VLAN Security Enhancements

#### ✅ VLAN Tagging Defense
- Use a **non-default VLAN ID** for default VLAN
- Helps prevent **VLAN double tagging attacks**

#### ✅ Trunk Port Control
- Explicitly configure which ports are trunks
- Prevent **access ports** from auto-enabling trunk mode
- Stops **VLAN hopping**

---

### 🌐 Spanning Tree & Root Bridge Protection

#### ✅ BPDU Guard
- Protects against **malicious root bridge changes**
- If BPDU is seen on a port **not meant to participate**, it’s:
  - Logged as an error
  - The port is **blocked**
- Prevents attacker from injecting false **Bridge Protocol Data Units**

#### ✅ Root Guard
- Prevents ports from **becoming new root bridges**
- Ensures the correct spanning tree hierarchy stays intact

---

### 🧠 Summary

| Feature         | Protects Against                        |
|------------------|------------------------------------------|
| DAI              | ARP spoofing, on-path attacks            |
| DHCP Snooping    | Rogue DHCP servers, IP spoofing          |
| RA Guard / ND    | IPv6 spoofing attacks                    |
| VLAN ID Change   | Double-tagging VLAN hopping              |
| Trunk Config     | VLAN hopping via rogue trunk ports       |
| BPDU Guard       | Spanning tree root bridge manipulation   |
| Root Guard       | Unauthorized root bridge election        |
