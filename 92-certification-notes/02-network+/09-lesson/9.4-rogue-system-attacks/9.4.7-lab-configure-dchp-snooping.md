#networking-plus #DCHP-snooping #snooping #lab #ARP 

## ðŸ§ª Lab: Discover a Rogue DHCP Server (9.4.6)

### âœ… Objective
Identify the rogue DHCP server using Wireshark.

---

### ðŸ”§ Steps Performed

1. **Capture DHCP traffic**
   - Interface used: `enp2s0`
   - Wireshark filter: `bootp`

2. **Force DHCP Discovery**
   - Disabled and re-enabled `enp2s0`:
     ```bash
     ip link set enp2s0 down
     ip link set enp2s0 up
     ```

3. **Analyze DHCP Offers**
   - Two DHCP Offers appeared:
     - `192.168.0.14` (legitimate)
     - `10.10.10.240` (rogue)

4. **Identified by Source Field**
   - Both offers had same **Transaction ID**: `0x615c0cf4`
   - Different source IPs offering same lease

---

### ðŸ§  Learnings

- **DHCP Offers** from multiple servers can indicate rogue behavior.
- Legitimate servers typically match the expected subnet.
- A rogue server often appears **outside the subnet** or with odd IP logic (e.g., `10.x.x.x` on `192.168.x.x` network).
- Transaction ID helps correlate which offer belongs to which Discover.

---

### ðŸ§ª Answers

- Rogue DHCP Server IP: `10.10.10.240`
- Legitimate DHCP Server IP: `192.168.0.14`

---

## ðŸ§ª Lab: Configure DHCP Snooping (9.4.7)

### âœ… Objective
Configure DHCP snooping and ARP inspection to protect against rogue DHCP servers.

---

### ðŸ”§ Steps Performed

1. **Enable DHCP Snooping Globally**
   ```plaintext
   SwitchA> enable
   SwitchA# config t
   SwitchA(config)# ip dhcp snooping
