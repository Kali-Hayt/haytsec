## 9.4.9 âœ… Lab: Analyze DNS Spoofing

### ðŸ§ª Scenario
You are the security analyst for a small corporate network. To understand how DNS spoofing works, you initiate a DNS spoofing attack using Ettercap and analyze the outcome. This is a defensive learning exercise to recognize how attackers redirect legitimate DNS queries in man-in-the-middle (on-path) attacks.

---

### ðŸŽ¯ Objectives
- View normal access to the **rmksupplies.com** website.
- Use Ettercap to:
  - Begin unified sniffing on interface `enp2s0`
  - Set Exec (192.168.0.30) as the target machine
  - Enable DNS spoofing with plugin
  - Initiate ARP poisoning
- Analyze the DNS spoof result from the Exec machine.

---

### ðŸ› ï¸ Step-by-Step

1. **View Baseline Behavior**
   - On **Support**, open Google Chrome.
   - Navigate to `rmksupplies.com`.
   - Confirm the real RMK Office Supplies site loads.

2. **Start Unified Sniffing**
   - Launch Ettercap.
   - Sniff â†’ Unified Sniffing â†’ Select `enp2s0` â†’ OK.

3. **Set Exec as Target**
   - Hosts â†’ Scan for hosts.
   - Hosts â†’ Host List â†’ Select `192.168.0.30` â†’ Add to Target 1.

4. **Enable DNS Spoofing**
   - Plugins â†’ Manage Plugins â†’ Activate `dns_spoof`.
   - Select Mitm â†’ ARP poisoning â†’ Sniff remote connections â†’ OK.

5. **Test Redirection**
   - On **Exec**, navigate to:
     - Top tabs â†’ **Floor 1 Overview**
     - Under Executive Office â†’ **Exec**
   - Open Chrome â†’ go to `rmksupplies.com`.

6. **Observe Result**
   - Website address stays the same (`rmksupplies.com`)
   - But content is from **RUS Office Supplies**.

---

### âœ… Result

> **Q1: Which of the following was a result of the DNS spoofing attack?**  
> âœ… Queries to the rmksupplies.com site were redirected to the RUS Office Supplies site.

---

