#netwokring-plus #tcpdump #tcp #sniffing #packet-capture #packets 

## 8.5.2 – `tcpdump`

### 🧱 Overview
- `tcpdump` is a **command-line packet capture utility** for Linux.
- It uses the **libpcap** library to capture and display network traffic.
- Useful for inspecting raw traffic in real time or saving it for later analysis.

---

### ✅ Basic Syntax
tcpdump -i eth0

- `eth0` is the **interface to listen on**.
- Use `any` to capture on **all interfaces** of a multi-homed host.
- Press `Ctrl+C` to stop the capture.

---

### 🧱 Common Switches
- `-i` → Specify network interface
- `-w` → **Write** output to a file
- `-r` → **Read** from a capture file
- `-v`, `-vv`, `-vvv` → Increase **verbosity**
- `-e` → Show Ethernet headers

---

### 🧱 Filter Types

- **Type**:  
  Filter by:
  - `host`
  - `net`
  - `port`
  - `portrange`

- **Direction**:  
  Filter by:
  - `src` (source) or `dst` (destination)  
  Applies to `host`, `network`, or `port`

- **Protocol**:  
  Filter by named protocols like:
  - `arp`, `icmp`, `ip`, `ip6`, `tcp`, `udp`, etc.

---

### 🧱 Boolean Operators
- `and` → `&&`  
- `or` → `||`  
- `not` → `!`

Use **parentheses** for grouping in complex filters.

---

### ✅ Example
To capture traffic from `10.1.0.100` going to **port 53 or 80**:

tcpdump -i eth0 "src host 10.1.0.100 and (dst port 53 or dst port 80)"


---

### 🔍 Related Tools
- `ngrep` (GitHub: `jpr5/ngrep`)  
  - Supports **regex packet matching**
- `netcat` (aka `ncat`)  
  - Copies traffic between hosts  
  - Good for scripted testing and piping
