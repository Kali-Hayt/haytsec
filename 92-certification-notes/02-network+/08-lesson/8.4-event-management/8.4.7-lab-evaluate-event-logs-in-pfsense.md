#lab #networking-plus #eventlog #log #dchp #spoofing #MITM #DHCPACK 
# 8.4.7 Lab: Evaluate Event Logs in pfSense  
**Candidate:** John Hayt  
**Time Spent:** 15:24  
**Score:** ✅ 100%

---

## ✅ Lab Question

### # Q1: What, if any, indication is there of an on-path attack?

- ✅ There are two DHCPACK entries with the same IP and MAC address.  
- ❌ There is no indication of an on-path attack. Everything looks fine.  
- ❌ There are two sets of DHCP handshaking entries (DORA).

**Why the others are wrong:**

- ❌ *"No indication..."* — Incorrect because there **is** clear evidence of tampering. Duplicate DHCPACKs point to a rogue DHCP server.  
- ❌ *"Two sets of DORA..."* — Misleading. That might suggest a second DHCP server, but the real red flag here is **duplicate ACKs**, not just duplicated handshakes.

---

## 🧱 How to Detect DHCP Spoofing (aka on-path MITM):
Watch for:
- Duplicate `DHCPACK` entries from different servers.
- Same IP/MAC handed out more than once.
- Inconsistent DORA sequences from different sources.

### Example log section:
```
Aug 02 12:50:34  dhcpd  DHCPACK on 192.168.1.110 to 00:15:5d:01:23:55 (Win10) via hn1  
Aug 02 12:50:34  dhcpd  DHCPACK on 192.168.1.110 to 00:15:5d:01:23:55 (Win10) via hn1
```
🛑 That's a double DHCPACK — both same IP, same MAC, same timestamp — **something's fishy**.

---

## 🛠️ Navigation Tips in pfSense

To view logs for DHCP:
- Go to `Status` → `System Logs`
- Click on `DHCP` tab

To view General Logs:
- Stay under `System Logs` → `System` → `General`

Keep an eye out for `sshguard`, `nginx`, `php-fpm`, and `dhcpd` process messages for alerts.

---

## 🔐 Takeaway

Two DHCPACKs with identical data suggest **a rogue DHCP server** is pretending to be legitimate. This is classic **on-path attack behavior**, often the groundwork for DNS spoofing, man-in-the-middle interception, or phishing redirection.

Keep your eyes on those logs like you're guarding the gates of your kingdom.

```
